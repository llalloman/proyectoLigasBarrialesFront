<div class="page-container">
  <header class="page-header">
    <h1>‚öΩ Sistema de Ligas Barriales</h1>
    <div class="user-info" *ngIf="user$ | async as user">
      <span>{{ user.nombre }}</span>
      <span class="user-role">{{ user.rol.nombre }}</span>
      <button class="btn-logout" (click)="logout()">Cerrar Sesi√≥n</button>
    </div>
  </header>

  <app-main-nav></app-main-nav>

  <div class="page-title">
    <h2>‚è≥ Transferencias Pendientes - Directivo</h2>
    <div class="header-actions">
      <button
        type="button"
        class="btn btn-secondary"
        routerLink="/transferencias"
      >
        ‚Üê Volver
      </button>
    </div>
  </div>

  <div class="info-box">
    <p>
      <strong>‚ÑπÔ∏è Informaci√≥n:</strong> Estas son las transferencias que ya
      fueron aprobadas por el equipo origen y est√°n pendientes de su aprobaci√≥n
      final. Al aprobar, el jugador ser√° transferido autom√°ticamente al equipo
      destino.
    </p>
  </div>

  <div class="alert alert-success" *ngIf="successMessage">
    {{ successMessage }}
  </div>

  <div class="alert alert-error" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <div class="loading-spinner" *ngIf="loading">
    <p>Cargando...</p>
  </div>

  <div class="empty-state" *ngIf="!loading && transferencias.length === 0">
    <p>‚úÖ No hay transferencias pendientes de su aprobaci√≥n</p>
  </div>

  <div class="cards-grid" *ngIf="!loading && transferencias.length > 0">
    <div class="card" *ngFor="let transferencia of transferencias">
      <div class="card-header">
        <div class="player-info">
          <img
            *ngIf="transferencia.jugador?.fotoPerfil || transferencia.jugador?.imagen"
            [src]="transferencia.jugador.fotoPerfil || transferencia.jugador.imagen"
            alt="{{ transferencia.jugador.nombreCompleto || transferencia.jugador.nombre }}"
            class="player-photo"
          />
          <div
            class="player-photo-placeholder"
            *ngIf="!transferencia.jugador?.fotoPerfil && !transferencia.jugador?.imagen"
          >
            üë§
          </div>
          <div>
            <h3>{{ transferencia.jugador?.nombreCompleto || transferencia.jugador?.nombre || 'Sin nombre' }}</h3>
            <p class="player-detail">{{ transferencia.jugador?.cedula }}</p>
          </div>
        </div>
        <span class="badge badge-pendiente">Pendiente</span>
      </div>

      <div class="card-body">
        <div class="info-row">
          <span class="label">Campeonato:</span>
          <span class="value">{{ transferencia.campeonato?.nombre }}</span>
        </div>

        <div class="transfer-flow">
          <div class="team-box origin">
            <span class="team-label">Equipo Origen</span>
            <span class="team-name">{{
              transferencia.equipoOrigen?.nombre
            }}</span>
          </div>
          <div class="arrow">‚Üí</div>
          <div class="team-box destination">
            <span class="team-label">Equipo Destino</span>
            <span class="team-name">{{
              transferencia.equipoDestino?.nombre
            }}</span>
          </div>
        </div>

        <div class="approval-status">
          <div class="status-item">
            <span class="status-label">Estado Equipo Origen:</span>
            <span
              class="badge badge-sm"
              [ngClass]="
                getEstadoEquipoOrigenClass(transferencia.estadoEquipoOrigen)
              "
            >
              {{ transferencia.estadoEquipoOrigen }}
            </span>
          </div>
          <div
            class="approval-info"
            *ngIf="transferencia.aprobadoPorOrigen"
          >
            <small class="text-muted"
              >Aprobado el
              {{ transferencia.fechaAprobacionOrigen | date: 'short' }}</small
            >
          </div>
        </div>

        <div class="info-row" *ngIf="transferencia.observaciones">
          <span class="label">Observaciones:</span>
          <span class="value">{{ transferencia.observaciones }}</span>
        </div>
        <div class="info-row">
          <span class="label">Fecha Solicitud:</span>
          <span class="value">{{
            transferencia.fechaSolicitud | date: 'short'
          }}</span>
        </div>
      </div>

      <div class="card-actions">
        <button
          type="button"
          class="btn-icon btn-success"
          (click)="aprobar(transferencia.id)"
          title="Aprobar"
        >
          ‚úÖ
        </button>
        <button
          type="button"
          class="btn-icon btn-danger"
          (click)="rechazar(transferencia.id)"
          title="Rechazar"
        >
          ‚ùå
        </button>
      </div>
    </div>
  </div>
</div>
